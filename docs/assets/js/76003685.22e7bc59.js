"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_book=self.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[442],{5679:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"part1-foundations/ros2-fundamentals","title":"Chapter 3: ROS 2 Fundamentals - Nodes, Topics, Services, Actions","description":"Learning Objectives","source":"@site/docs/part1-foundations/03-ros2-fundamentals.md","sourceDirName":"part1-foundations","slug":"/part1-foundations/ros2-fundamentals","permalink":"/robot_book/docs/part1-foundations/ros2-fundamentals","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"bookSidebar","previous":{"title":"Chapter 2: Development Environment Setup - ROS 2, Isaac Sim, and Hardware","permalink":"/robot_book/docs/part1-foundations/development-environment-setup"},"next":{"title":"Chapter 4: Robot Description - URDF, SDF, and Xacro for Humanoids","permalink":"/robot_book/docs/part1-foundations/robot-description-urdf-sdf"}}');var r=s(4848),o=s(8453);const t={},l="Chapter 3: ROS 2 Fundamentals - Nodes, Topics, Services, Actions",a={},c=[{value:"1. ROS 2 Conceptual Overview",id:"1-ros-2-conceptual-overview",level:2},{value:"1.1 Why ROS 2 vs. ROS 1 (DDS, Real-Time, Security)",id:"11-why-ros-2-vs-ros-1-dds-real-time-security",level:3},{value:"1.2 ROS 2 Architecture: Nodes, Topics, Services, Actions, Parameters",id:"12-ros-2-architecture-nodes-topics-services-actions-parameters",level:3},{value:"1.3 Quality of Service (QoS) Policies",id:"13-quality-of-service-qos-policies",level:3},{value:"2. Nodes and Topics",id:"2-nodes-and-topics",level:2},{value:"2.1 Creating a Simple Publisher (Python)",id:"21-creating-a-simple-publisher-python",level:3},{value:"2.2 Creating a Simple Subscriber (Python)",id:"22-creating-a-simple-subscriber-python",level:3},{value:"2.3 Understanding Message Types (std_msgs, sensor_msgs, geometry_msgs)",id:"23-understanding-message-types-std_msgs-sensor_msgs-geometry_msgs",level:3},{value:"2.4 QoS Policies for Topics: Reliability, Durability, History",id:"24-qos-policies-for-topics-reliability-durability-history",level:3},{value:"3. Services for Request-Reply",id:"3-services-for-request-reply",level:2},{value:"3.1 Defining a Custom Service (.srv Files)",id:"31-defining-a-custom-service-srv-files",level:3},{value:"3.2 Implementing a Service Server (Python)",id:"32-implementing-a-service-server-python",level:3},{value:"3.3 Calling a Service from a Client (Python)",id:"33-calling-a-service-from-a-client-python",level:3},{value:"3.4 Synchronous vs. Asynchronous Service Calls",id:"34-synchronous-vs-asynchronous-service-calls",level:3},{value:"4. Actions for Long-Running Tasks",id:"4-actions-for-long-running-tasks",level:2},{value:"4.1 Action Definition (.action Files): Goal, Feedback, Result",id:"41-action-definition-action-files-goal-feedback-result",level:3},{value:"4.2 Implementing an Action Server (Python)",id:"42-implementing-an-action-server-python",level:3},{value:"4.3 Implementing an Action Client with Feedback Handling (Python)",id:"43-implementing-an-action-client-with-feedback-handling-python",level:3},{value:"4.4 Use Case: Navigation Goal with Progress Feedback",id:"44-use-case-navigation-goal-with-progress-feedback",level:3},{value:"5. Parameters and Launch Files",id:"5-parameters-and-launch-files",level:2},{value:"5.1 Declaring and Using Parameters in Nodes (Python)",id:"51-declaring-and-using-parameters-in-nodes-python",level:3},{value:"5.2 Launch Files: Orchestrating Multi-Node Systems (Python)",id:"52-launch-files-orchestrating-multi-node-systems-python",level:3},{value:"5.3 YAML Parameter Files for Configuration",id:"53-yaml-parameter-files-for-configuration",level:3},{value:"6. Debugging and Introspection Tools",id:"6-debugging-and-introspection-tools",level:2},{value:"6.1 <code>ros2 topic</code> Commands",id:"61-ros2-topic-commands",level:3},{value:"6.2 <code>ros2 service</code> Commands",id:"62-ros2-service-commands",level:3},{value:"6.3 <code>rqt_graph</code> for Visualizing Node Connections",id:"63-rqt_graph-for-visualizing-node-connections",level:3},{value:"6.4 <code>ros2 bag</code> for Recording and Replaying Data",id:"64-ros2-bag-for-recording-and-replaying-data",level:3},{value:"7. Hands-On Lab: Building a Multi-Node System",id:"7-hands-on-lab-building-a-multi-node-system",level:2},{value:"8. End-of-Chapter Project: Humanoid Joint Controller Action Server",id:"8-end-of-chapter-project-humanoid-joint-controller-action-server",level:2},{value:"9. Further Reading",id:"9-further-reading",level:2},{value:"Chapter Summary",id:"chapter-summary",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-3-ros-2-fundamentals---nodes-topics-services-actions",children:"Chapter 3: ROS 2 Fundamentals - Nodes, Topics, Services, Actions"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Learning Objectives"})}),"\n",(0,r.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Explain the architectural differences between ROS 1 and ROS 2 (DDS middleware, real-time support, security)"}),"\n",(0,r.jsx)(n.li,{children:"Create ROS 2 nodes in Python and C++ that publish and subscribe to topics"}),"\n",(0,r.jsx)(n.li,{children:"Understand and configure Quality of Service (QoS) policies for reliable communication"}),"\n",(0,r.jsx)(n.li,{children:"Implement service servers and clients for request-reply patterns"}),"\n",(0,r.jsx)(n.li,{children:"Build action servers with goal, feedback, and result handling for long-running tasks"}),"\n",(0,r.jsx)(n.li,{children:"Use parameters and launch files to configure multi-node systems"}),"\n",(0,r.jsxs)(n.li,{children:["Debug ROS 2 systems using command-line tools (",(0,r.jsx)(n.code,{children:"ros2 topic"}),", ",(0,r.jsx)(n.code,{children:"ros2 service"}),", ",(0,r.jsx)(n.code,{children:"rqt_graph"}),", ",(0,r.jsx)(n.code,{children:"ros2 bag"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Build a complete multi-node sensor processing system with topics, services, and actions"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prerequisites"}),": Completed Chapter 2 (ROS 2 Iron installed, development environment configured)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Estimated Time"}),": 12-16 hours (including hands-on lab and project)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-ros-2-conceptual-overview",children:"1. ROS 2 Conceptual Overview"}),"\n",(0,r.jsx)(n.h3,{id:"11-why-ros-2-vs-ros-1-dds-real-time-security",children:"1.1 Why ROS 2 vs. ROS 1 (DDS, Real-Time, Security)"}),"\n",(0,r.jsx)(n.p,{children:"ROS 1 (Robot Operating System 1) revolutionized robotics research from 2007-2020, enabling rapid prototyping through a rich ecosystem of packages. However, industrial adoption revealed critical limitations that ROS 2 addresses."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ROS 1 Limitations"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"No Real-Time Support"}),": ROS 1 uses TCP for communication, which has unpredictable latency due to packet buffering and retransmission. Critical control loops (motor controllers running at 1 kHz) cannot tolerate 100+ ms latency spikes."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Single Master Architecture"}),": ",(0,r.jsx)(n.code,{children:"roscore"})," is a single point of failure. If the ROS master crashes, the entire system fails. Multi-robot systems require complex master synchronization."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"No Native Security"}),": All ROS 1 communication is unencrypted. Any node on the network can subscribe to any topic, publish malicious data, or eavesdrop on sensor streams. This is unacceptable for commercial robots handling sensitive data."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Poor Windows Support"}),": ROS 1 was designed for Ubuntu. Windows and macOS support was an afterthought, limiting adoption in mixed-OS environments (e.g., Windows developer laptops + Linux robots)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ROS 2 Solutions"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"DDS Middleware (Data Distribution Service)"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 uses DDS, an OMG (Object Management Group) standard middleware designed for real-time, distributed systems"}),"\n",(0,r.jsx)(n.li,{children:"DDS implementations: Fast DDS (default), CycloneDDS, Connext DDS"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key Advantage"}),": DDS provides Quality of Service (QoS) policies\u2014you can specify reliability (guaranteed delivery vs. best-effort), durability (late-joining subscribers get historical data), and deadline (detect when publishers go silent)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"No Single Point of Failure"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 uses DDS discovery\u2014nodes find each other via multicast without a central master"}),"\n",(0,r.jsx)(n.li,{children:"Each node is autonomous; if one crashes, others continue operating"}),"\n",(0,r.jsxs)(n.li,{children:["Multi-robot systems work out-of-the-box (set different ",(0,r.jsx)(n.code,{children:"ROS_DOMAIN_ID"})," values)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"DDS-Security (SROS2)"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Encrypt all communication with AES-256"}),"\n",(0,r.jsx)(n.li,{children:"Authenticate nodes with X.509 certificates (PKI infrastructure)"}),"\n",(0,r.jsxs)(n.li,{children:["Fine-grained access control (node A can publish to ",(0,r.jsx)(n.code,{children:"/cmd_vel"})," but not subscribe to ",(0,r.jsx)(n.code,{children:"/camera"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Warehouse robots handling proprietary inventory data; hospital robots processing patient information"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cross-Platform Support"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 officially supports Ubuntu, Windows 10/11, macOS (Intel + Apple Silicon)"}),"\n",(0,r.jsx)(n.li,{children:"Real-time operating systems: VxWorks, QNX, FreeRTOS (for embedded systems)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Migration Path"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 1 Bridge package allows ROS 1 and ROS 2 nodes to communicate during transition"}),"\n",(0,r.jsx)(n.li,{children:"Most popular ROS 1 packages (MoveIt, Nav2, Gazebo) have ROS 2 equivalents"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Performance Comparison"})," (benchmarks on Intel i7-12700K):"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"ROS 1 (Noetic)"}),(0,r.jsx)(n.th,{children:"ROS 2 (Iron)"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Topic Latency (avg)"})}),(0,r.jsx)(n.td,{children:"1.2 ms"}),(0,r.jsx)(n.td,{children:"0.8 ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Topic Latency (p99)"})}),(0,r.jsx)(n.td,{children:"15 ms"}),(0,r.jsx)(n.td,{children:"3 ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Throughput (10 KB msgs)"})}),(0,r.jsx)(n.td,{children:"450 MB/s"}),(0,r.jsx)(n.td,{children:"680 MB/s"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Discovery Time (50 nodes)"})}),(0,r.jsx)(n.td,{children:"8 seconds"}),(0,r.jsx)(n.td,{children:"2 seconds"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source"}),": ROS 2 Performance Benchmarks (Open Robotics, 2023)"]}),"\n",(0,r.jsx)(n.h3,{id:"12-ros-2-architecture-nodes-topics-services-actions-parameters",children:"1.2 ROS 2 Architecture: Nodes, Topics, Services, Actions, Parameters"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 systems are composed of ",(0,r.jsx)(n.strong,{children:"nodes"}),"\u2014independent processes that communicate via well-defined interfaces. This modular architecture enables code reuse, parallel development, and graceful degradation."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Node"}),": A single-purpose executable (e.g., ",(0,r.jsx)(n.code,{children:"camera_driver"}),", ",(0,r.jsx)(n.code,{children:"object_detector"}),", ",(0,r.jsx)(n.code,{children:"motor_controller"}),")"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Written in Python, C++, or other languages (Rust, Java support via client libraries)"}),"\n",(0,r.jsx)(n.li,{children:"Runs as an OS process (one node = one process)"}),"\n",(0,r.jsx)(n.li,{children:"Can be composed into a single process for performance (composition)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Communication Patterns"}),":"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Topics (Publish-Subscribe)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Streaming sensor data (camera images at 30 Hz, IMU at 100 Hz)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pattern"}),": One-to-many (1 publisher, N subscribers) or many-to-many"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example"}),": ",(0,r.jsx)(n.code,{children:"/camera/rgb"})," topic carries ",(0,r.jsx)(n.code,{children:"sensor_msgs/Image"})," messages"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Services (Request-Reply)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Trigger an action and wait for result (reset odometry, switch camera mode)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pattern"}),": One-to-one (client sends request, server sends response)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example"}),": ",(0,r.jsx)(n.code,{children:"/reset_odometry"})," service (Empty request \u2192 Empty response)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Actions (Goal-Feedback-Result)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Long-running tasks with progress updates (navigate to waypoint, grasp object)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pattern"}),": One-to-one with streaming feedback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example"}),": ",(0,r.jsx)(n.code,{children:"/navigate_to_pose"})," action sends periodic feedback (distance remaining, ETA)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Parameters"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Configure node behavior without recompiling (set PID gains, camera resolution)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pattern"}),": Key-value store per node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example"}),": ",(0,r.jsx)(n.code,{children:"camera.exposure_time"})," parameter (integer, microseconds)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Analogy to Software Design Patterns"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Topics \u2248 Observer pattern (subscribers observe publisher state changes)"}),"\n",(0,r.jsx)(n.li,{children:"Services \u2248 Remote Procedure Call (RPC)"}),"\n",(0,r.jsx)(n.li,{children:"Actions \u2248 Futures/Promises with progress callbacks"}),"\n",(0,r.jsx)(n.li,{children:"Parameters \u2248 Configuration files"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"13-quality-of-service-qos-policies",children:"1.3 Quality of Service (QoS) Policies"}),"\n",(0,r.jsx)(n.p,{children:"QoS policies control the reliability and performance of topic communication. Mismatched QoS between publisher and subscriber prevents communication\u2014this is a common pitfall."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key QoS Policies"}),":"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Reliability"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"RELIABLE"})}),": Guaranteed delivery (TCP-like). DDS retransmits lost packets. Use for critical data (joint commands, goal poses)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"BEST_EFFORT"})}),": No retransmission (UDP-like). Accepts packet loss. Use for high-frequency sensor data (camera images, LiDAR scans)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Durability"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"VOLATILE"})}),": Late-joining subscribers only receive messages published after subscription."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"TRANSIENT_LOCAL"})}),": Late-joining subscribers receive the last N messages (determined by History depth). Use for configuration topics (e.g., robot state)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. History"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"KEEP_LAST(N)"})}),": Store last N messages. If queue fills, oldest message is dropped."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"KEEP_ALL"})}),": Store all messages (unbounded queue\u2014risk of memory exhaustion)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Deadline"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Detect when publisher stops publishing. If no message received within deadline period, subscriber is notified."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Motor safety\u2014if ",(0,r.jsx)(n.code,{children:"/cmd_vel"})," topic goes silent for >500 ms, emergency stop."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"5. Lifespan"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Messages expire after a time duration (e.g., 1 second). Stale data is discarded."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": GPS waypoints that are only valid for 10 seconds."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common QoS Presets"})," (defined in ",(0,r.jsx)(n.code,{children:"rclpy.qos"})," and ",(0,r.jsx)(n.code,{children:"rclcpp"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Python example\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\n\n# Sensor data preset (best-effort, volatile, keep last 10)\nsensor_qos = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\n# System default preset (reliable, volatile, keep last 10)\ndefault_qos = QoSProfile(\n    reliability=ReliabilityPolicy.RELIABLE,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\n# Parameter events preset (reliable, transient local, keep all)\nparameter_qos = QoSProfile(\n    reliability=ReliabilityPolicy.RELIABLE,\n    durability=DurabilityPolicy.TRANSIENT_LOCAL,\n    history=HistoryPolicy.KEEP_ALL\n)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"QoS Compatibility"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Publishers and subscribers must have compatible QoS"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compatible"}),": Reliable publisher + Reliable subscriber \u2705"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compatible"}),": Best-effort publisher + Best-effort subscriber \u2705"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Incompatible"}),": Reliable subscriber + Best-effort publisher \u274c (subscriber won't receive messages)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rule"}),": Subscribers can request stricter reliability than publishers offer, but not vice versa"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging QoS Mismatches"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check QoS settings for a topic\nros2 topic info /camera/rgb --verbose\n\n# Output shows publisher and subscriber QoS policies\nPublishers:\n  * /camera_driver (sensor_msgs/msg/Image)\n    QoS: Reliability=BEST_EFFORT, Durability=VOLATILE, Depth=10\nSubscribers:\n  * /object_detector (sensor_msgs/msg/Image)\n    QoS: Reliability=RELIABLE, Durability=VOLATILE, Depth=10\n    WARNING: QoS mismatch - subscriber won't receive messages!\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-nodes-and-topics",children:"2. Nodes and Topics"}),"\n",(0,r.jsx)(n.h3,{id:"21-creating-a-simple-publisher-python",children:"2.1 Creating a Simple Publisher (Python)"}),"\n",(0,r.jsx)(n.p,{children:"Let's create a publisher that publishes IMU (Inertial Measurement Unit) data at 50 Hz."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"sensor_simulator.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nfrom std_msgs.msg import Header\nimport numpy as np\n\nclass SensorSimulator(Node):\n    def __init__(self):\n        super().__init__('sensor_simulator')\n\n        # Create publisher for /imu topic\n        self.publisher_ = self.create_publisher(Imu, '/imu', 10)\n\n        # Create timer (20 ms = 50 Hz)\n        self.timer = self.create_timer(0.02, self.timer_callback)\n\n        # Simulation state\n        self.count = 0\n\n        self.get_logger().info('Sensor simulator started, publishing to /imu at 50 Hz')\n\n    def timer_callback(self):\n        msg = Imu()\n\n        # Header with timestamp\n        msg.header = Header()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'imu_link'\n\n        # Simulate accelerometer (gravity + noise)\n        msg.linear_acceleration.x = np.random.normal(0.0, 0.1)\n        msg.linear_acceleration.y = np.random.normal(0.0, 0.1)\n        msg.linear_acceleration.z = np.random.normal(9.81, 0.1)\n\n        # Simulate gyroscope (random noise)\n        msg.angular_velocity.x = np.random.normal(0.0, 0.05)\n        msg.angular_velocity.y = np.random.normal(0.0, 0.05)\n        msg.angular_velocity.z = np.random.normal(0.0, 0.05)\n\n        # Orientation (set to identity quaternion)\n        msg.orientation.w = 1.0\n        msg.orientation.x = 0.0\n        msg.orientation.y = 0.0\n        msg.orientation.z = 0.0\n\n        # Publish message\n        self.publisher_.publish(msg)\n\n        self.count += 1\n        if self.count % 100 == 0:  # Log every 2 seconds\n            self.get_logger().info(f'Published {self.count} IMU messages')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SensorSimulator()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Running the Publisher"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x sensor_simulator.py\npython3 sensor_simulator.py\n\n# Output:\n# [INFO] [sensor_simulator]: Sensor simulator started, publishing to /imu at 50 Hz\n# [INFO] [sensor_simulator]: Published 100 IMU messages\n# [INFO] [sensor_simulator]: Published 200 IMU messages\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Code Breakdown"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"super().__init__('sensor_simulator')"}),": Initialize node with name ",(0,r.jsx)(n.code,{children:"sensor_simulator"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.create_publisher(Imu, '/imu', 10)"}),": Create publisher for topic ",(0,r.jsx)(n.code,{children:"/imu"})," with message type ",(0,r.jsx)(n.code,{children:"Imu"})," and queue size 10"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.create_timer(0.02, self.timer_callback)"}),": Call ",(0,r.jsx)(n.code,{children:"timer_callback()"})," every 20 ms (50 Hz)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.get_clock().now().to_msg()"}),": Get current ROS time (not system time\u2014important for simulation and bag playback)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"22-creating-a-simple-subscriber-python",children:"2.2 Creating a Simple Subscriber (Python)"}),"\n",(0,r.jsxs)(n.p,{children:["Now create a subscriber that listens to ",(0,r.jsx)(n.code,{children:"/imu"})," and applies a simple moving average filter."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"filter_node.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nfrom collections import deque\n\nclass FilterNode(Node):\n    def __init__(self):\n        super().__init__('filter_node')\n\n        # Create subscriber\n        self.subscription = self.create_subscription(\n            Imu,\n            '/imu',\n            self.imu_callback,\n            10\n        )\n\n        # Create publisher for filtered data\n        self.publisher_ = self.create_publisher(Imu, '/imu_filtered', 10)\n\n        # Moving average filter (window size = 5)\n        self.window_size = 5\n        self.accel_x_buffer = deque(maxlen=self.window_size)\n        self.accel_y_buffer = deque(maxlen=self.window_size)\n        self.accel_z_buffer = deque(maxlen=self.window_size)\n\n        self.get_logger().info('Filter node started, subscribing to /imu')\n\n    def imu_callback(self, msg):\n        # Add to buffers\n        self.accel_x_buffer.append(msg.linear_acceleration.x)\n        self.accel_y_buffer.append(msg.linear_acceleration.y)\n        self.accel_z_buffer.append(msg.linear_acceleration.z)\n\n        # Compute moving average\n        filtered_msg = Imu()\n        filtered_msg.header = msg.header\n        filtered_msg.header.frame_id = 'imu_link_filtered'\n\n        filtered_msg.linear_acceleration.x = sum(self.accel_x_buffer) / len(self.accel_x_buffer)\n        filtered_msg.linear_acceleration.y = sum(self.accel_y_buffer) / len(self.accel_y_buffer)\n        filtered_msg.linear_acceleration.z = sum(self.accel_z_buffer) / len(self.accel_z_buffer)\n\n        # Copy gyroscope (no filtering)\n        filtered_msg.angular_velocity = msg.angular_velocity\n        filtered_msg.orientation = msg.orientation\n\n        # Publish filtered data\n        self.publisher_.publish(filtered_msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = FilterNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Testing Publisher + Subscriber"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Run publisher\npython3 sensor_simulator.py\n\n# Terminal 2: Run subscriber\npython3 filter_node.py\n\n# Terminal 3: Check topics\nros2 topic list\n# Output:\n# /imu\n# /imu_filtered\n# /parameter_events\n# /rosout\n\n# Terminal 3: Verify rates\nros2 topic hz /imu\n# average rate: 50.023 Hz\n\nros2 topic hz /imu_filtered\n# average rate: 50.018 Hz\n"})}),"\n",(0,r.jsx)(n.h3,{id:"23-understanding-message-types-std_msgs-sensor_msgs-geometry_msgs",children:"2.3 Understanding Message Types (std_msgs, sensor_msgs, geometry_msgs)"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 messages are defined in ",(0,r.jsx)(n.code,{children:".msg"})," files and compiled to Python/C++ classes."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common Message Packages"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. std_msgs"})," (standard messages):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"std_msgs/String - string data\nstd_msgs/Int32 - int32 data\nstd_msgs/Float64 - float64 data\nstd_msgs/Bool - bool data\nstd_msgs/Header - timestamp + frame_id\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. sensor_msgs"})," (sensor data):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"sensor_msgs/Image - camera images\nsensor_msgs/Imu - IMU (accelerometer + gyroscope)\nsensor_msgs/LaserScan - 2D LiDAR scans\nsensor_msgs/PointCloud2 - 3D point clouds\nsensor_msgs/JointState - robot joint positions/velocities/efforts\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. geometry_msgs"})," (geometric primitives):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"geometry_msgs/Point - (x, y, z)\ngeometry_msgs/Pose - position + orientation (quaternion)\ngeometry_msgs/Twist - linear + angular velocity\ngeometry_msgs/Transform - translation + rotation\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Inspecting Message Definitions"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Show Imu message structure\nros2 interface show sensor_msgs/msg/Imu\n\n# Output:\n# std_msgs/Header header\n#   builtin_interfaces/Time stamp\n#   string frame_id\n# geometry_msgs/Quaternion orientation\n# float64[9] orientation_covariance\n# geometry_msgs/Vector3 angular_velocity\n# float64[9] angular_velocity_covariance\n# geometry_msgs/Vector3 linear_acceleration\n# float64[9] linear_acceleration_covariance\n"})}),"\n",(0,r.jsx)(n.h3,{id:"24-qos-policies-for-topics-reliability-durability-history",children:"2.4 QoS Policies for Topics: Reliability, Durability, History"}),"\n",(0,r.jsx)(n.p,{children:"Let's modify the publisher to use best-effort QoS (appropriate for high-frequency sensor data):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\n\nclass SensorSimulator(Node):\n    def __init__(self):\n        super().__init__('sensor_simulator')\n\n        # Define QoS profile (best-effort for sensor data)\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n\n        # Create publisher with custom QoS\n        self.publisher_ = self.create_publisher(Imu, '/imu', qos_profile)\n        # ... rest of code\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Subscriber with Matching QoS"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class FilterNode(Node):\n    def __init__(self):\n        super().__init__('filter_node')\n\n        # Subscriber must use compatible QoS\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n\n        self.subscription = self.create_subscription(\n            Imu,\n            '/imu',\n            self.imu_callback,\n            qos_profile\n        )\n        # ... rest of code\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-services-for-request-reply",children:"3. Services for Request-Reply"}),"\n",(0,r.jsx)(n.h3,{id:"31-defining-a-custom-service-srv-files",children:"3.1 Defining a Custom Service (.srv Files)"}),"\n",(0,r.jsxs)(n.p,{children:["Services use ",(0,r.jsx)(n.code,{children:".srv"})," files with request and response fields separated by ",(0,r.jsx)(n.code,{children:"---"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"my_interfaces/srv/CalibrateImu.srv"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Request (empty - just trigger calibration)\n---\n# Response\nbool success\nstring message\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Building Custom Messages"})," (requires ROS 2 package):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Create package for custom interfaces\ncd ~/ros2_ws/src\nros2 pkg create my_interfaces --build-type ament_cmake\n\n# Add srv file\nmkdir -p my_interfaces/srv\n# Copy CalibrateImu.srv to my_interfaces/srv/\n\n# Edit CMakeLists.txt to add:\nfind_package(rosidl_default_generators REQUIRED)\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "srv/CalibrateImu.srv"\n)\n\n# Build\ncd ~/ros2_ws\ncolcon build --packages-select my_interfaces\nsource install/setup.bash\n'})}),"\n",(0,r.jsx)(n.h3,{id:"32-implementing-a-service-server-python",children:"3.2 Implementing a Service Server (Python)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"calibration_service.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool  # Using built-in service for simplicity\n\nclass CalibrationService(Node):\n    def __init__(self):\n        super().__init__('calibration_service')\n\n        # Create service server\n        self.srv = self.create_service(\n            SetBool,\n            '/calibrate_imu',\n            self.calibrate_callback\n        )\n\n        self.bias_x = 0.0\n        self.bias_y = 0.0\n        self.bias_z = 0.0\n\n        self.get_logger().info('Calibration service ready at /calibrate_imu')\n\n    def calibrate_callback(self, request, response):\n        \"\"\"\n        Request: bool data (True = calibrate, False = reset)\n        Response: bool success, string message\n        \"\"\"\n        if request.data:  # Calibrate\n            # Simulate calibration (in reality, would collect samples)\n            self.bias_x = 0.05\n            self.bias_y = -0.03\n            self.bias_z = 0.02\n\n            response.success = True\n            response.message = f'Calibration complete. Bias: x={self.bias_x}, y={self.bias_y}, z={self.bias_z}'\n\n            self.get_logger().info(response.message)\n        else:  # Reset\n            self.bias_x = 0.0\n            self.bias_y = 0.0\n            self.bias_z = 0.0\n\n            response.success = True\n            response.message = 'Bias reset to zero'\n\n            self.get_logger().info(response.message)\n\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = CalibrationService()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"33-calling-a-service-from-a-client-python",children:"3.3 Calling a Service from a Client (Python)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Command-Line Client"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Call service from terminal\nros2 service call /calibrate_imu example_interfaces/srv/SetBool \"{data: true}\"\n\n# Output:\n# requester: making request: example_interfaces.srv.SetBool_Request(data=True)\n# response: example_interfaces.srv.SetBool_Response(success=True, message='Calibration complete. Bias: x=0.05, y=-0.03, z=0.02')\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Programmatic Client"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool\n\nclass CalibrationClient(Node):\n    def __init__(self):\n        super().__init__('calibration_client')\n\n        # Create client\n        self.client = self.create_client(SetBool, '/calibrate_imu')\n\n        # Wait for service to be available\n        while not self.client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Waiting for /calibrate_imu service...')\n\n        self.get_logger().info('Service available')\n\n    def send_request(self, calibrate=True):\n        request = SetBool.Request()\n        request.data = calibrate\n\n        # Call service asynchronously\n        future = self.client.call_async(request)\n        return future\n\ndef main(args=None):\n    rclpy.init(args=args)\n    client = CalibrationClient()\n\n    # Send request\n    future = client.send_request(calibrate=True)\n\n    # Wait for response\n    rclpy.spin_until_future_complete(client, future)\n\n    if future.result() is not None:\n        response = future.result()\n        client.get_logger().info(f'Service response: {response.message}')\n    else:\n        client.get_logger().error('Service call failed')\n\n    client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"34-synchronous-vs-asynchronous-service-calls",children:"3.4 Synchronous vs. Asynchronous Service Calls"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Synchronous Call"})," (blocks until response):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# WARNING: Blocks the executor - don't use in timer callbacks\nrequest = SetBool.Request()\nrequest.data = True\nresponse = self.client.call(request)  # Blocks here\nprint(response.message)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Asynchronous Call"})," (non-blocking):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Preferred method - doesn't block\nfuture = self.client.call_async(request)\n\n# Option 1: Spin until complete\nrclpy.spin_until_future_complete(node, future)\nresponse = future.result()\n\n# Option 2: Add callback\ndef response_callback(future):\n    response = future.result()\n    node.get_logger().info(f'Got response: {response.message}')\n\nfuture.add_done_callback(response_callback)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-actions-for-long-running-tasks",children:"4. Actions for Long-Running Tasks"}),"\n",(0,r.jsx)(n.h3,{id:"41-action-definition-action-files-goal-feedback-result",children:"4.1 Action Definition (.action Files): Goal, Feedback, Result"}),"\n",(0,r.jsx)(n.p,{children:"Actions have three components: Goal (what to do), Feedback (progress updates), Result (final outcome)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"my_interfaces/action/ComputeTrajectory.action"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Goal\nfloat64 computation_time  # How long to compute (seconds)\n---\n# Result\nbool success\nstring message\nfloat64[] trajectory  # Computed trajectory (dummy data)\n---\n# Feedback\nfloat64 percent_complete\nfloat64 time_remaining\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Build Action"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Edit CMakeLists.txt to add action file\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "srv/CalibrateImu.srv"\n  "action/ComputeTrajectory.action"\n  DEPENDENCIES builtin_interfaces\n)\n\n# Rebuild\ncd ~/ros2_ws\ncolcon build --packages-select my_interfaces\nsource install/setup.bash\n'})}),"\n",(0,r.jsx)(n.h3,{id:"42-implementing-an-action-server-python",children:"4.2 Implementing an Action Server (Python)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"long_computation_action.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci  # Using built-in action for simplicity\nimport time\n\nclass LongComputationActionServer(Node):\n    def __init__(self):\n        super().__init__('long_computation_action_server')\n\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            '/compute_trajectory',\n            self.execute_callback\n        )\n\n        self.get_logger().info('Action server ready at /compute_trajectory')\n\n    def execute_callback(self, goal_handle):\n        \"\"\"\n        Execute the goal and publish feedback.\n\n        Args:\n            goal_handle: Handle to manage goal execution\n\n        Returns:\n            Result message\n        \"\"\"\n        self.get_logger().info(f'Executing goal: order={goal_handle.request.order}')\n\n        # Simulate 5-second computation\n        total_duration = 5.0\n        update_rate = 10  # Hz\n        num_updates = int(total_duration * update_rate)\n\n        # Initialize feedback\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        # Simulate computation with progress feedback\n        for i in range(num_updates):\n            # Check if goal was canceled\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                result = Fibonacci.Result()\n                result.sequence = feedback_msg.sequence\n                return result\n\n            # Compute next Fibonacci number (limited to goal.order)\n            if len(feedback_msg.sequence) < goal_handle.request.order:\n                feedback_msg.sequence.append(\n                    feedback_msg.sequence[-1] + feedback_msg.sequence[-2]\n                )\n\n            # Publish feedback\n            goal_handle.publish_feedback(feedback_msg)\n\n            percent_complete = (i + 1) / num_updates * 100\n            self.get_logger().info(f'Progress: {percent_complete:.1f}%')\n\n            time.sleep(1.0 / update_rate)\n\n        # Mark goal as succeeded\n        goal_handle.succeed()\n\n        # Return result\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n\n        self.get_logger().info(f'Goal succeeded with result: {result.sequence}')\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = LongComputationActionServer()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"43-implementing-an-action-client-with-feedback-handling-python",children:"4.3 Implementing an Action Client with Feedback Handling (Python)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"action_client.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass ComputeTrajectoryClient(Node):\n    def __init__(self):\n        super().__init__('compute_trajectory_client')\n\n        self._action_client = ActionClient(self, Fibonacci, '/compute_trajectory')\n\n        self.get_logger().info('Waiting for action server...')\n        self._action_client.wait_for_server()\n        self.get_logger().info('Action server available')\n\n    def send_goal(self, order):\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self.get_logger().info(f'Sending goal: order={order}')\n\n        # Send goal with callbacks\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n\n        if not goal_handle.accepted:\n            self.get_logger().error('Goal rejected')\n            return\n\n        self.get_logger().info('Goal accepted')\n\n        # Wait for result\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def feedback_callback(self, feedback_msg):\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f'Feedback: {feedback.sequence}')\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Result: {result.sequence}')\n\n        # Shutdown after receiving result\n        rclpy.shutdown()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    client = ComputeTrajectoryClient()\n\n    # Send goal\n    client.send_goal(order=10)\n\n    # Spin until result received\n    rclpy.spin(client)\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Testing Action Server + Client"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Run action server\npython3 long_computation_action.py\n\n# Terminal 2: Run action client\npython3 action_client.py\n\n# Terminal 1 Output:\n# [INFO] [long_computation_action_server]: Executing goal: order=10\n# [INFO] [long_computation_action_server]: Progress: 10.0%\n# [INFO] [long_computation_action_server]: Progress: 20.0%\n# ...\n# [INFO] [long_computation_action_server]: Goal succeeded with result: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n\n# Terminal 2 Output:\n# [INFO] [compute_trajectory_client]: Sending goal: order=10\n# [INFO] [compute_trajectory_client]: Goal accepted\n# [INFO] [compute_trajectory_client]: Feedback: [0, 1]\n# [INFO] [compute_trajectory_client]: Feedback: [0, 1, 1]\n# ...\n# [INFO] [compute_trajectory_client]: Result: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"44-use-case-navigation-goal-with-progress-feedback",children:"4.4 Use Case: Navigation Goal with Progress Feedback"}),"\n",(0,r.jsx)(n.p,{children:"Actions are ideal for navigation tasks where the robot moves to a goal pose and provides periodic feedback on distance remaining."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pseudocode for Navigation Action"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Goal: target pose (x, y, theta)\n# Feedback: current pose, distance remaining, ETA\n# Result: final pose, success/failure\n\nclass NavigateToP oseActionServer:\n    def execute_callback(self, goal_handle):\n        target_pose = goal_handle.request.pose\n\n        while not_at_target(target_pose):\n            current_pose = get_current_pose()\n            distance = compute_distance(current_pose, target_pose)\n\n            # Publish feedback\n            feedback = NavigateToPose.Feedback()\n            feedback.current_pose = current_pose\n            feedback.distance_remaining = distance\n            feedback.eta = distance / velocity\n            goal_handle.publish_feedback(feedback)\n\n            # Move toward target\n            cmd_vel = compute_velocity(current_pose, target_pose)\n            publish_cmd_vel(cmd_vel)\n\n            sleep(0.1)  # 10 Hz control loop\n\n        # Goal reached\n        result = NavigateToPose.Result()\n        result.final_pose = get_current_pose()\n        result.success = True\n        return result\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-parameters-and-launch-files",children:"5. Parameters and Launch Files"}),"\n",(0,r.jsx)(n.h3,{id:"51-declaring-and-using-parameters-in-nodes-python",children:"5.1 Declaring and Using Parameters in Nodes (Python)"}),"\n",(0,r.jsx)(n.p,{children:"Parameters allow runtime configuration without recompiling code."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"configurable_filter.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nfrom collections import deque\n\nclass ConfigurableFilterNode(Node):\n    def __init__(self):\n        super().__init__('configurable_filter')\n\n        # Declare parameters with default values\n        self.declare_parameter('window_size', 5)\n        self.declare_parameter('output_topic', '/imu_filtered')\n        self.declare_parameter('publish_rate', 50.0)\n\n        # Get parameter values\n        window_size = self.get_parameter('window_size').value\n        output_topic = self.get_parameter('output_topic').value\n        publish_rate = self.get_parameter('publish_rate').value\n\n        self.get_logger().info(f'Parameters: window_size={window_size}, output_topic={output_topic}, publish_rate={publish_rate}')\n\n        # Create subscriber and publisher\n        self.subscription = self.create_subscription(Imu, '/imu', self.imu_callback, 10)\n        self.publisher_ = self.create_publisher(Imu, output_topic, 10)\n\n        # Initialize buffers\n        self.accel_x_buffer = deque(maxlen=window_size)\n        self.accel_y_buffer = deque(maxlen=window_size)\n        self.accel_z_buffer = deque(maxlen=window_size)\n\n    def imu_callback(self, msg):\n        # ... same filtering logic as before ...\n        pass\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ConfigurableFilterNode()\n    rclpy.spin(node)\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Setting Parameters at Runtime"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set parameters via command line\nros2 run my_package configurable_filter.py --ros-args \\\n  -p window_size:=10 \\\n  -p output_topic:=/imu_smoothed \\\n  -p publish_rate:=100.0\n\n# List parameters of running node\nros2 param list /configurable_filter\n# Output:\n# publish_rate\n# output_topic\n# use_sim_time\n# window_size\n\n# Get parameter value\nros2 param get /configurable_filter window_size\n# Integer value is: 10\n\n# Set parameter on running node\nros2 param set /configurable_filter window_size 20\n# Set parameter successful\n"})}),"\n",(0,r.jsx)(n.h3,{id:"52-launch-files-orchestrating-multi-node-systems-python",children:"5.2 Launch Files: Orchestrating Multi-Node Systems (Python)"}),"\n",(0,r.jsx)(n.p,{children:"Launch files start multiple nodes with specified parameters and remappings."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"multi_node.launch.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        # Sensor simulator node\n        Node(\n            package='my_package',\n            executable='sensor_simulator.py',\n            name='sensor_simulator',\n            output='screen',\n            parameters=[{\n                'publish_rate': 50.0\n            }]\n        ),\n\n        # Filter node\n        Node(\n            package='my_package',\n            executable='configurable_filter.py',\n            name='filter_node',\n            output='screen',\n            parameters=[{\n                'window_size': 10,\n                'output_topic': '/imu_filtered',\n                'publish_rate': 50.0\n            }]\n        ),\n\n        # Calibration service\n        Node(\n            package='my_package',\n            executable='calibration_service.py',\n            name='calibration_service',\n            output='screen'\n        ),\n\n        # Action server\n        Node(\n            package='my_package',\n            executable='long_computation_action.py',\n            name='long_computation_action_server',\n            output='screen'\n        ),\n    ])\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Running Launch File"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 launch my_package multi_node.launch.py\n\n# Output shows all nodes starting:\n# [sensor_simulator-1] [INFO] [sensor_simulator]: Sensor simulator started\n# [filter_node-2] [INFO] [configurable_filter]: Parameters: window_size=10, output_topic=/imu_filtered\n# [calibration_service-3] [INFO] [calibration_service]: Calibration service ready\n# [long_computation_action_server-4] [INFO] [long_computation_action_server]: Action server ready\n"})}),"\n",(0,r.jsx)(n.h3,{id:"53-yaml-parameter-files-for-configuration",children:"5.3 YAML Parameter Files for Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"config/params.yaml"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"sensor_simulator:\n  ros__parameters:\n    publish_rate: 100.0\n    add_noise: true\n    noise_stddev: 0.05\n\nfilter_node:\n  ros__parameters:\n    window_size: 20\n    output_topic: '/imu_smoothed'\n    publish_rate: 100.0\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Launch File with YAML Parameters"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    config = os.path.join(\n        get_package_share_directory('my_package'),\n        'config',\n        'params.yaml'\n    )\n\n    return LaunchDescription([\n        Node(\n            package='my_package',\n            executable='sensor_simulator.py',\n            name='sensor_simulator',\n            parameters=[config]\n        ),\n        Node(\n            package='my_package',\n            executable='configurable_filter.py',\n            name='filter_node',\n            parameters=[config]\n        ),\n    ])\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-debugging-and-introspection-tools",children:"6. Debugging and Introspection Tools"}),"\n",(0,r.jsxs)(n.h3,{id:"61-ros2-topic-commands",children:["6.1 ",(0,r.jsx)(n.code,{children:"ros2 topic"})," Commands"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"List all topics"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Echo topic data"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Print all messages\nros2 topic echo /imu\n\n# Print only once\nros2 topic echo /imu --once\n\n# Print without arrays (for large data)\nros2 topic echo /imu --no-arr\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Check topic rate"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic hz /imu\n# average rate: 50.023 Hz\n#   min: 0.019s max: 0.021s std dev: 0.00012s window: 51\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Topic info"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic info /imu --verbose\n# Type: sensor_msgs/msg/Imu\n# Publisher count: 1\n# Subscription count: 1\n#\n# Publishers:\n#   * /sensor_simulator (rmw_fastrtps_cpp)\n#     QoS: Reliability=BEST_EFFORT, Durability=VOLATILE, Depth=10\n#\n# Subscriptions:\n#   * /filter_node (rmw_fastrtps_cpp)\n#     QoS: Reliability=BEST_EFFORT, Durability=VOLATILE, Depth=10\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Publish to topic from command line"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'ros2 topic pub /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 0.5}, angular: {z: 0.1}}" --rate 10\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"62-ros2-service-commands",children:["6.2 ",(0,r.jsx)(n.code,{children:"ros2 service"})," Commands"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"List services"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 service list\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Call service"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'ros2 service call /calibrate_imu example_interfaces/srv/SetBool "{data: true}"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Service type"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 service type /calibrate_imu\n# example_interfaces/srv/SetBool\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"63-rqt_graph-for-visualizing-node-connections",children:["6.3 ",(0,r.jsx)(n.code,{children:"rqt_graph"})," for Visualizing Node Connections"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rqt_graph"})," provides a visual graph of nodes, topics, services, and actions."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Launch rqt_graph"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 run rqt_graph rqt_graph\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Graph shows"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ovals: Nodes"}),"\n",(0,r.jsx)(n.li,{children:"Boxes: Topics"}),"\n",(0,r.jsx)(n.li,{children:"Arrows: Publisher \u2192 Topic \u2192 Subscriber relationships"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case"}),": Debug why a subscriber isn't receiving messages (check if topic names match, if QoS is compatible)."]}),"\n",(0,r.jsxs)(n.h3,{id:"64-ros2-bag-for-recording-and-replaying-data",children:["6.4 ",(0,r.jsx)(n.code,{children:"ros2 bag"})," for Recording and Replaying Data"]}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 bags record all topic data to a database file (SQLite3) for later replay."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Record topics"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Record specific topics\nros2 bag record /imu /imu_filtered -o my_bag\n\n# Record all topics\nros2 bag record -a -o full_system_bag\n\n# Output:\n# [INFO] [rosbag2_storage]: Opened database 'my_bag/my_bag_0.db3'.\n# [INFO] [rosbag2_transport]: Listening for topics...\n# [INFO] [rosbag2_transport]: Subscribed to topic '/imu'\n# [INFO] [rosbag2_transport]: Subscribed to topic '/imu_filtered'\n# Press Ctrl+C to stop recording\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Inspect bag"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 bag info my_bag\n\n# Output:\n# Files:             my_bag_0.db3\n# Bag size:          2.3 MB\n# Storage id:        sqlite3\n# Duration:          30.2s\n# Start:             Jan 15 2025 10:30:15.123\n# End:               Jan 15 2025 10:30:45.321\n# Messages:          3020\n# Topic information:\n#   Topic: /imu | Type: sensor_msgs/msg/Imu | Count: 1510 | Serialization Format: cdr\n#   Topic: /imu_filtered | Type: sensor_msgs/msg/Imu | Count: 1510 | Serialization Format: cdr\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Replay bag"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 bag play my_bag\n\n# Replay at 2x speed\nros2 bag play my_bag --rate 2.0\n\n# Replay in loop\nros2 bag play my_bag --loop\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Offline Development"}),": Record sensor data in field, develop algorithms offline"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regression Testing"}),": Record ground-truth data, replay to test algorithm changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Debugging"}),": Record data when bug occurs, replay multiple times to debug"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-hands-on-lab-building-a-multi-node-system",children:"7. Hands-On Lab: Building a Multi-Node System"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Build a complete sensor processing system with 4 nodes communicating via topics, services, and actions."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Time Estimate"}),": 8 hours"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"System Architecture"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"sensor_simulator \u2192 /imu (50 Hz) \u2192 filter_node \u2192 /imu_filtered (50 Hz)\n                                         \u2193\n                               calibration_service (/calibrate_imu service)\n                               long_computation_action (/compute_trajectory action)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tasks"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 Create ",(0,r.jsx)(n.code,{children:"sensor_simulator.py"})," (already completed in Section 2.1)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Create ",(0,r.jsx)(n.code,{children:"filter_node.py"})," (already completed in Section 2.2)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Create ",(0,r.jsx)(n.code,{children:"calibration_service.py"})," (already completed in Section 3.2)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Create ",(0,r.jsx)(n.code,{children:"long_computation_action.py"})," (already completed in Section 4.2)"]}),"\n",(0,r.jsxs)(n.li,{children:["Create launch file ",(0,r.jsx)(n.code,{children:"multi_node.launch.py"})," (see Section 5.2)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Step 6: Test the Complete System"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Terminal 1: Launch all nodes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 launch my_package multi_node.launch.py\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Terminal 2: Verify topics"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic hz /imu\nros2 topic hz /imu_filtered\n\n# Both should show ~50 Hz\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Terminal 3: Call calibration service"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 service call /calibrate_imu example_interfaces/srv/SetBool \"{data: true}\"\n\n# Expected: success=True, message='Calibration complete...'\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Terminal 4: Send action goal"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'ros2 action send_goal /compute_trajectory example_interfaces/action/Fibonacci "{order: 15}" --feedback\n\n# Expected: Periodic feedback with Fibonacci sequence, then result\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Validation Criteria"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Launch file starts all 4 nodes without errors"}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"/imu"})," topic publishes at 49-51 Hz"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"/imu_filtered"})," topic publishes at 49-51 Hz"]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Calibration service responds within 100 ms"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Action server provides feedback every ~500 ms"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Action completes after ~5 seconds"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common Issues"}),":"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Issue 1: Topic rate drops below 40 Hz"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": System CPU overload"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Reduce publish rate to 30 Hz or run on more powerful hardware"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Issue 2: Service call times out"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": Service server not running or different namespace"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": ",(0,r.jsx)(n.code,{children:"ros2 service list"})," to verify service exists"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Issue 3: Action feedback not received"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": Action server not publishing feedback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Check action server code has ",(0,r.jsx)(n.code,{children:"goal_handle.publish_feedback()"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-end-of-chapter-project-humanoid-joint-controller-action-server",children:"8. End-of-Chapter Project: Humanoid Joint Controller Action Server"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Create a ROS 2 action server that accepts a joint trajectory goal and executes it on the Isaac Sim humanoid from Chapter 2."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Requirements"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Definition"})," (",(0,r.jsx)(n.code,{children:"JointTrajectory.action"}),"):"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Goal\nstring[] joint_names\nfloat64[] target_positions\nfloat64 duration\n---\n# Result\nbool success\nstring message\nfloat64 final_error  # Sum of squared errors\n---\n# Feedback\nfloat64 percent_complete\nfloat64 time_remaining\nfloat64[] current_positions\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Server"})," (",(0,r.jsx)(n.code,{children:"humanoid_joint_controller.py"}),"):"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Subscribe to ",(0,r.jsx)(n.code,{children:"/joint_states"})," to get current joint positions"]}),"\n",(0,r.jsxs)(n.li,{children:["Interpolate from current positions to target positions over ",(0,r.jsx)(n.code,{children:"duration"})," seconds"]}),"\n",(0,r.jsxs)(n.li,{children:["Publish joint commands to Isaac Sim (via ",(0,r.jsx)(n.code,{children:"/joint_command"})," topic)"]}),"\n",(0,r.jsx)(n.li,{children:"Provide feedback every 100 ms (10 Hz)"}),"\n",(0,r.jsx)(n.li,{children:"Validate final positions are within 5% of target"}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Launch File"})," (",(0,r.jsx)(n.code,{children:"humanoid_controller.launch.py"}),"):"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Start Isaac Sim ROS 2 bridge"}),"\n",(0,r.jsx)(n.li,{children:"Start action server"}),"\n",(0,r.jsx)(n.li,{children:"Load humanoid URDF from Chapter 2"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example Usage"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Launch Isaac Sim + action server\nros2 launch my_package humanoid_controller.launch.py\n\n# Terminal 2: Send goal (move arms to 90\xb0 shoulder flexion)\nros2 action send_goal /joint_trajectory my_interfaces/action/JointTrajectory \\\n  \"{joint_names: ['left_shoulder', 'right_shoulder'], target_positions: [1.57, 1.57], duration: 3.0}\" \\\n  --feedback\n\n# Expected feedback:\n# Feedback: percent_complete=10.0, time_remaining=2.7, current_positions=[0.17, 0.17]\n# Feedback: percent_complete=20.0, time_remaining=2.4, current_positions=[0.31, 0.31]\n# ...\n# Feedback: percent_complete=100.0, time_remaining=0.0, current_positions=[1.57, 1.57]\n#\n# Result: success=True, message='Trajectory executed successfully', final_error=0.002\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Deliverables"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Action definition file (",(0,r.jsx)(n.code,{children:"JointTrajectory.action"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Action server code (",(0,r.jsx)(n.code,{children:"humanoid_joint_controller.py"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Launch file (",(0,r.jsx)(n.code,{children:"humanoid_controller.launch.py"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Video demonstration (30-60 seconds) showing Isaac Sim humanoid executing smooth arm motion"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Validation Criteria"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Trajectory completes within 10% of specified duration (e.g., 3.0 \xb1 0.3 seconds)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Final joint positions within 5% of target (e.g., 1.57 \xb1 0.08 radians)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Feedback published at 10 Hz (\xb11 Hz)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 No joint limit violations (checked via URDF limits)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Smooth motion (no abrupt velocity changes)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-further-reading",children:"9. Further Reading"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Official Documentation"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["ROS 2 Design Documentation: ",(0,r.jsx)(n.a,{href:"https://design.ros2.org/",children:"https://design.ros2.org/"})]}),"\n",(0,r.jsxs)(n.li,{children:["DDS Specification: ",(0,r.jsx)(n.a,{href:"https://www.omg.org/spec/DDS/",children:"https://www.omg.org/spec/DDS/"})]}),"\n",(0,r.jsxs)(n.li,{children:["ROS 2 QoS Policies: ",(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/iron/Concepts/About-Quality-of-Service-Settings.html",children:"https://docs.ros.org/en/iron/Concepts/About-Quality-of-Service-Settings.html"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommended Books"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Programming Robots with ROS 2"})," (Ayala & Koub\xe2a, 2023)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"ROS 2 Robotics Developer Guide"})," (Ibrahim, 2024)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Community Resources"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["ROS Discourse: ",(0,r.jsx)(n.a,{href:"https://discourse.ros.org/",children:"https://discourse.ros.org/"})]}),"\n",(0,r.jsxs)(n.li,{children:["ROS Answers: ",(0,r.jsx)(n.a,{href:"https://answers.ros.org/",children:"https://answers.ros.org/"})]}),"\n",(0,r.jsxs)(n.li,{children:["GitHub Discussions: ",(0,r.jsx)(n.a,{href:"https://github.com/ros2/ros2/discussions",children:"https://github.com/ros2/ros2/discussions"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"chapter-summary",children:"Chapter Summary"}),"\n",(0,r.jsx)(n.p,{children:"This chapter introduced ROS 2 fundamentals through hands-on examples. You learned the architectural advantages of ROS 2 over ROS 1 (DDS middleware, no single point of failure, security), created publishers and subscribers with QoS policies, implemented services for request-reply patterns, and built action servers for long-running tasks with feedback."}),"\n",(0,r.jsxs)(n.p,{children:["You configured nodes with parameters, orchestrated multi-node systems with launch files, and debugged using ",(0,r.jsx)(n.code,{children:"ros2 topic"}),", ",(0,r.jsx)(n.code,{children:"ros2 service"}),", ",(0,r.jsx)(n.code,{children:"rqt_graph"}),", and ",(0,r.jsx)(n.code,{children:"ros2 bag"}),". Finally, you built a complete sensor processing system with 4 nodes and an end-of-chapter project controlling a humanoid's joints via action server."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key Takeaways"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 uses DDS middleware for real-time, decentralized, secure communication"}),"\n",(0,r.jsx)(n.li,{children:"QoS policies must be compatible between publishers and subscribers (e.g., reliable vs. best-effort)"}),"\n",(0,r.jsx)(n.li,{children:"Services are synchronous request-reply (block until response); actions are asynchronous with feedback"}),"\n",(0,r.jsx)(n.li,{children:"Parameters enable runtime configuration without recompiling"}),"\n",(0,r.jsx)(n.li,{children:"Launch files simplify starting multi-node systems with specified parameters"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ros2 topic hz"})," and ",(0,r.jsx)(n.code,{children:"ros2 bag"})," are essential debugging tools"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Next Steps"}),": In Chapter 4, we'll dive into robot description formats\u2014URDF, SDF, and Xacro for humanoids. You'll learn to define links (visual, collision, inertial properties), joints (revolute, prismatic, fixed), and create modular humanoid models with Xacro macros."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.p,{children:["Ayala, A., & Koub\xe2a, A. (2023). ",(0,r.jsx)(n.em,{children:"Programming robots with ROS 2: Develop robotics applications with the most powerful open-source framework"}),". Packt Publishing."]}),"\n",(0,r.jsxs)(n.p,{children:["Ibrahim, A. (2024). ",(0,r.jsx)(n.em,{children:"ROS 2 robotics developer guide"}),". Packt Publishing."]}),"\n",(0,r.jsxs)(n.p,{children:["Macenski, S., Foote, T., Gerkey, B., Lalancette, C., & Woodall, W. (2022). Robot Operating System 2: Design, architecture, and uses in the wild. ",(0,r.jsx)(n.em,{children:"Science Robotics"}),", 7(66), eabm6074."]}),"\n",(0,r.jsxs)(n.p,{children:["Object Management Group. (2015). ",(0,r.jsx)(n.em,{children:"Data Distribution Service (DDS) Version 1.4"}),". OMG Document formal/2015-04-10."]}),"\n",(0,r.jsxs)(n.p,{children:["Open Robotics. (2024). ",(0,r.jsx)(n.em,{children:"ROS 2 Iron Irwini documentation"}),". ",(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/iron/",children:"https://docs.ros.org/en/iron/"})]}),"\n",(0,r.jsxs)(n.p,{children:["Quigley, M., Gerkey, B., & Smart, W. D. (2015). ",(0,r.jsx)(n.em,{children:"Programming robots with ROS: A practical introduction to the Robot Operating System"}),". O'Reilly Media."]}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 Design Team. (2024). ",(0,r.jsx)(n.em,{children:"ROS 2 design documentation"}),". ",(0,r.jsx)(n.a,{href:"https://design.ros2.org/",children:"https://design.ros2.org/"})]}),"\n",(0,r.jsxs)(n.p,{children:["Thomas, D., & Woodall, W. (2023). ",(0,r.jsx)(n.em,{children:"ROS 2 performance benchmarks"}),". Open Robotics Technical Report TR-2023-001."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);